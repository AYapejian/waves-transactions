<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="https://unpkg.com/vue"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
</head>
<body>
    <div id="app">
        <div class="container">
            <div class="row">
                <div class="col">
                    <form class="form-inline" @submit.prevent="fetchTransactions">
                        <label class="sr-only" for="walletAddress">Wallet Address</label>
                        <input type="text" class="form-control mb-2 mr-sm-2 mb-sm-0" id="walletAddress" placeholder="Enter wallet address" v-model="walletAddress">
                        <button :disabled="!walletAddress" @click.prevent="fetchTransactions" type="submit" class="btn btn-primary">Fetch Transactions</button>
                    </form>
                </div>
            </div>
        </div>

        <hr />
        <div class="progress" v-if="isFetching">
            <div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div>
        </div>

        <table class="table" v-if="transactions && transactions.length">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Type</th>
                    <th>Asset Symbol</th>
                    <th>Fee Symbol</th>
                    <th>Amount</th>
                    <th>Fee</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="t of transactions">
                    <td>{{t.date}}</td>
                    <td>{{t.type }}</td>
                    <td>{{t.assetSymbol}}</td>
                    <td>{{t.feeSymbol}}</td>
                    <td>{{t.amount}}</td>
                    <td>{{t.fee}}</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>

    const app = new Vue({
      el: '#app',
      data: {
        walletAddress: '',
        limit:         5000,
        error:         '',
        transactions:  [],
        isFetching:    false
      },
      methods: {
        fetchTransactions: function () {
            this.isFetching = true;
            return axios.get(`/transactions/${this.walletAddress}/limit/${this.limit}`)
                .then(res => {
                    this.isFetching = false;
                    this.transactions = res.data;
                })
                .catch(e => {
                    this.isFetching = false;
                    this.error = e;
                });
        }
      }
    })
  </script>
</body>
</html>
